table.mt-3.table.table-bordered
	thead.thead-light
		th 品牌
		th 系列
		th 产品规格
		th 工艺面料
		th(style="width:10%") 备注
		th 数量价格
	thead
		- let estTot = 0;
		- let qntTot = 0;
		each qunpd in qunpds
			-a;
			tr.text-info(id="tr-compdid-"+qunpd._id)
				td
					if qunpd.brand
						- brand = qunpd.brand;
						.brandnome [#{brand.nome}]
					else
						.brandnome #{qunpd.brandNome}

					if qunpd.area
						-a;
						.pdarea.mt-3
							span.text-dark 区域: 
							span #{qunpd.area}

					if qun.status == Conf.status.init.num || qun.status == Conf.status.quoting.num
							a-;
							a.btn.border-warning.text-warning.mt-5(href="/slQunpdUp/"+qunpd._id) 更改商品
				td
					.pdnome
						span.text-dark 品类: 
						span #{qunpd.pdNome}
					if qunpd.pdfir
						- pdfir = qunpd.pdfir;
						.pdfircode.mt-3
							span.text-dark 系列名: 
							span [#{pdfir.code}]
					else
						- let firNome = '产品系列名称';
						if qunpd.firNome
							- firNome = qunpd.firNome;
						.firnome.mt-3
							span.text-dark 系列名: 
							span #{firNome}
					.photo.mt-3
						- let photo = "/imgs/createPicture.jpg";
						if qunpd.photo
							- photo = qunpd.photo;
							img(src=photo, width="120px")
							form(method="post", action="/slQunpdDelPic", enctype="multipart/form-data")
								input(type="hidden", name="compdId", value=qunpd._id)
								input(type="hidden", name="picField", value="photo")
								button.btn.btn-link.text-danger(type="submit") <span class="oi oi-trash"></span>
								a(href=photo, target="_blank") <span class="oi oi-zoom-in"></span>
						else if qunpd.pdfir
							- photo = qunpd.pdfir.photo;
							img(src=photo, width="120px")
							.picLink
								a(href=photo, target="_blank") <span class="oi oi-zoom-in"></span>
						else
							img(src=photo, width="120px")
				td
					if qunpd.pdsec
						- pdsec = qunpd.pdsec;
						.pdseccode
							span.text-dark 产品编码: 
							span [#{pdsec.code}]
						.pdsecspec.mt-3
							span.text-dark 产品尺寸: 
							span [#{pdsec.spec}]
					else
						.pdseccode
							span.text-dark 产品编码: 
							span #{qunpd.secNome}
						.pdsecspec.mt-3
							span.text-dark 产品尺寸: 
							span #{qunpd.specf}

					.sketch.mt-3
						- let sketch = "/imgs/createPicture.jpg";
						if qunpd.sketch
							- sketch = qunpd.sketch;
							img#sketchCrt(src=sketch, width="120px")
							form(method="post", action="/slQunpdDelPic", enctype="multipart/form-data")
								input(type="hidden", name="compdId", value=qunpd._id)
								input(type="hidden", name="picField", value="sketch")
								button.btn.btn-link.text-danger(type="submit") <span class="oi oi-trash"></span>
								a(href=sketch, target="_blank") <span class="oi oi-zoom-in"></span>
						else if qunpd.pdsec
							-a;
							- sketch = qunpd.pdsec.photo;
							img#sketchCrt(src=sketch, width="120px")
							.picLink
								a(href=sketch, target="_blank") <span class="oi oi-zoom-in"></span>
						else
							img#sketchCrt(src=sketch, width="120px")
				td
					- let pdthdcode = '查找数据库';
					if qunpd.pdthd
						- pdthdcode = '['+qunpd.pdthd.code+']';
					.pdthdcode #{pdthdcode}
					.pdmater.mt-3 #{qunpd.mater}
					.pdcraft.mt-3 #{qunpd.craft}
					.images
						- let subsp = -1;
						each image in qunpd.images
							- subsp++;
							if image && image.length > 5
								-a;
								img.mt-2(src=image, width="120px")
								form(method="post", action="/slQunpdDelPic", enctype="multipart/form-data")
									input(type="hidden", name="compdId", value=qunpd._id)
									input(type="hidden", name="picField", value="images")
									input(type="hidden", name="subsp", value=subsp)
									button.btn.btn-link.text-danger(type="submit") <span class="oi oi-trash"></span>
									a(href=image, target="_blank") <span class="oi oi-zoom-in"></span>
				td
					span #{qunpd.note}
				td
					.quant
						span.text-dark 数量: 
						span #{qunpd.quant}

					- let estimate = '未预估';
					if qunpd.estimate
						- estimate += parseFloat(qunpd.estimate);
						if !isNaN(estTot)
						- estimate = qunpd.estimate;
					else
						- estTot = '未预估';
					.price.mt-3
						if qun.status == Conf.status.quoting.num
							-a;
							span.text-dark 预估单价:
							if qunpd.estimate
								- a;
								span #{qunpd.estimate}
							else
								span.text-dark  未预估
						else
							span.text-dark 单价:
							if qunpd.qntPr
								- a;
								span #{qunpd.qntPr}
							else
								span.text-dark  未报价

					h5.total.mt-2
						if qun.status == Conf.status.quoting.num
							-a;
							span.text-dark 预估总价:
							if qunpd.estimate
								- a;
								span #{qunpd.estimate * qunpd.quant}
							else
								span.text-dark  未预估
						else
							span.text-dark 总价:
							if qunpd.qntPr
								- qntPr = qunpd.qntPr;
								span #{qunpd.qntPr * qunpd.quant}
							else
								span.text-dark  未报价

					.qunpdSts.mt-5
						- let status = '';
						each sts in Conf.status
							- status = '';
							if sts.num == qunpd.qntpdSts
								- status = sts.val;
								- break;
						span.text-dark 商品状态: 
						if qun.status > Conf.status.init.num
							-a;
							span.text-danger #{status}
						else
							span.text-danger 创建中